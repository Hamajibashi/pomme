import{S as u}from"./sweetalert2.all-cc361385.js";import{_ as k,m as S,a as C,r as f,o as n,c as p,i as T,f as d,T as E,d as t,b as e,F as h,h as j,t as r,w as g,e as B,n as b}from"./index-f453f472.js";import{C as v}from"./CartStore-b88fbe34.js";const{VITE_BASEURL:U,VITE_APIPATH:A}={VITE_BASEURL:"https://vue3-course-api.hexschool.io",VITE_APIPATH:"hmjbs",BASE_URL:"/pomme/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},N={data(){return{form:{user:{name:"",email:"",tel:"",address:""},message:""}}},methods:{createOrder(){const l=this.form,s=`${U}/v2/api/${A}/order`;this.axios.post(s,{data:l}).then(c=>{u.fire({iconColor:"#004c34",iconHtml:'<i class="bi bi-check-circle-fill"></i>',text:`${c.data.message}`,showConfirmButton:!1,width:250,timer:1200}),this.$refs.form.resetForm(),this.getCart(),this.$router.push(`/checkout/${c.data.orderId}`)}).catch(c=>{u.fire({iconColor:"#992525",iconHtml:'<i class="bi bi-exclamation-triangle-fill"></i>',text:`${c.response.data.message}`,showConfirmButton:!1,width:250,timer:1500})})},...S(v,["getCart"])},computed:{...C(v,["cart","total","final_total","isLoading"])},mounted(){this.getCart()}},F={class:"container-md"},I={class:"py-5"},L=B('<div class="mb-5 d-flex flex-column flex-sm-row text-center justify-content-center align-items-center"><div class="bg-secondary text-light p-3 w-100"><span class="fs-7">Step.1</span><p class="mb-0">訂單建立</p></div><i class="bi bi-arrow-right fs-4 mx-2 d-none d-sm-block"></i><i class="bi bi-arrow-down fs-4 mb-2 d-sm-none"></i><div class="bg-primary text-light p-3 w-100"><span class="fs-7">Step.2</span><p class="mb-0">確認結帳</p></div><i class="bi bi-arrow-right fs-4 mx-2 d-none d-sm-block"></i><i class="bi bi-arrow-down fs-4 mb-2 d-sm-none"></i><div class="bg-primary text-light p-3 w-100"><span class="fs-7">Step.3</span><p class="mb-0">完成訂單</p></div></div>',1),q={class:"row flex-row-reverse justify-content-center"},O={class:"col-lg-5"},P={class:"border p-4 mb-4"},R=e("h4",{class:"fw-bold mb-3"},"訂單明細",-1),D=["src","alt"],H={class:"w-100"},$={class:"d-flex justify-content-between"},z={class:"mb-0 fw-bold"},M={class:"mb-0"},G={class:"mb-0 fs-7"},J={key:0,class:"border-top pt-4"},K={class:"d-flex justify-content-between"},Q=e("p",{class:"mb-0 h4 fw-bold"},"總計",-1),W={class:"mb-0 h4 fw-bold"},X={key:1,class:"border-top pt-4"},Y={class:"d-flex justify-content-between mb-2 text-muted"},Z=e("p",{class:"mb-0"},"總計",-1),ee={class:"mb-0"},se={class:"d-flex justify-content-between mb-0 fw-bold h4"},te=e("p",{class:"mb-0"},"優惠價",-1),oe={class:"mb-0"},le={class:"col-lg-7"},ae={class:"mb-3"},ie=e("label",{for:"name",class:"form-label d-flex align-items-center"},[d("收件人姓名"),e("span",{class:"badge bg-danger ms-2"},"必填")],-1),ne={class:"mb-3"},re=e("label",{for:"email",class:"form-label d-flex align-items-center"},[d("收件人 Email"),e("span",{class:"badge bg-danger ms-2"},"必填")],-1),de={class:"mb-3"},ce=e("label",{for:"tel",class:"form-label d-flex align-items-center"},[d("收件人電話"),e("span",{class:"badge bg-danger ms-2"},"必填")],-1),me={class:"mb-3"},fe=e("label",{for:"address",class:"form-label d-flex align-items-center"},[d("收件人地址"),e("span",{class:"badge bg-danger ms-2"},"必填")],-1),pe={class:"mb-3"},_e=e("label",{for:"message",class:"form-label"},"留言",-1),be={class:"d-flex justify-content-between align-items-center"},ue=e("i",{class:"bi bi-caret-left-fill"},null,-1),he=["disabled"];function ge(l,s,c,ve,a,w){const x=f("loading-component"),m=f("VeeField"),_=f("error-message"),V=f("router-link"),y=f("VeeForm");return n(),p(h,null,[(n(),T(E,{to:"title"},[d(" | 建立訂單")])),t(x,{active:l.isLoading,"z-index":1060},null,8,["active"]),e("div",F,[e("div",I,[L,e("div",q,[e("div",O,[e("div",P,[R,(n(!0),p(h,null,j(l.cart,o=>(n(),p("div",{class:"d-flex mb-4",key:o.id},[e("img",{src:o.product.imageUrl,alt:o.product.title,class:"me-2 img-fluid object-cover",style:{width:"48px",height:"48px"}},null,8,D),e("div",H,[e("div",$,[e("p",z,r(o.product.title),1),e("p",M,"NT$ "+r(o.product.price),1)]),e("p",G,"數量："+r(o.qty),1)])]))),128)),l.total===l.final_total?(n(),p("div",J,[e("div",K,[Q,e("p",W,"NT$ "+r(l.final_total),1)])])):(n(),p("div",X,[e("div",Y,[Z,e("p",ee,"NT$ "+r(l.total),1)]),e("div",se,[te,e("p",oe,"NT$ "+r(l.final_total),1)])]))])]),e("div",le,[t(y,{ref:"form",onSubmit:w.createOrder},{default:g(({errors:o})=>[e("div",ae,[ie,t(m,{id:"name",name:"姓名",type:"text",class:b(["form-control",{"is-invalid":o.姓名}]),placeholder:"請輸入姓名",rules:"required",modelValue:a.form.user.name,"onUpdate:modelValue":s[0]||(s[0]=i=>a.form.user.name=i)},null,8,["class","modelValue"]),t(_,{name:"姓名",class:"invalid-feedback"})]),e("div",ne,[re,t(m,{id:"email",name:"email",type:"email",class:b(["form-control",{"is-invalid":o.email}]),placeholder:"請輸入 Email",rules:"email|required",modelValue:a.form.user.email,"onUpdate:modelValue":s[1]||(s[1]=i=>a.form.user.email=i)},null,8,["class","modelValue"]),t(_,{name:"email",class:"invalid-feedback"})]),e("div",de,[ce,t(m,{id:"tel",name:"電話",type:"tel",class:b(["form-control",{"is-invalid":o.電話}]),placeholder:"請輸入電話",rules:"required|min:8|integer",modelValue:a.form.user.tel,"onUpdate:modelValue":s[2]||(s[2]=i=>a.form.user.tel=i)},null,8,["class","modelValue"]),t(_,{name:"電話",class:"invalid-feedback"})]),e("div",me,[fe,t(m,{id:"address",name:"地址",type:"text",class:b(["form-control",{"is-invalid":o.地址}]),placeholder:"請輸入地址",rules:"required",modelValue:a.form.user.address,"onUpdate:modelValue":s[3]||(s[3]=i=>a.form.user.address=i)},null,8,["class","modelValue"]),t(_,{name:"地址",class:"invalid-feedback"})]),e("div",pe,[_e,t(m,{id:"message",name:"留言",class:"form-control",placeholder:"有任何需求歡迎填寫",cols:"30",rows:"8",maxlength:"50",modelValue:a.form.message,"onUpdate:modelValue":s[4]||(s[4]=i=>a.form.message=i),as:"textarea"},null,8,["modelValue"])]),e("div",be,[t(V,{to:"/cart",class:"text-decoration-none"},{default:g(()=>[ue,d(" 回到購物車")]),_:1}),e("button",{type:"submit",class:"btn btn-primary",disabled:l.cart.length===0},"送出訂單",8,he)])]),_:1},8,["onSubmit"])])])])])],64)}const ye=k(N,[["render",ge]]);export{ye as default};
