import{S as h}from"./sweetalert2.all-cc361385.js";import{_ as v,r as b,o as d,c as i,i as p,f as c,T as m,d as n,b as s,n as u,w as x,t as e,F as f,h as k,e as S}from"./index-f453f472.js";const{VITE_BASEURL:g,VITE_APIPATH:w}={VITE_BASEURL:"https://vue3-course-api.hexschool.io",VITE_APIPATH:"hmjbs",BASE_URL:"/pomme/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},E={data(){return{order:{products:{},user:{}},id:"",isLoading:!1}},methods:{getOrder(){this.isLoading=!0,this.id=this.$route.params.id;const l=`${g}/v2/api/${w}/order/${this.id}`;this.axios.get(l).then(r=>{this.order=r.data.order,this.isLoading=!1}).catch(r=>{this.isLoading=!1,console.log(r.response)})},payOrder(){const l=`${g}/v2/api/${w}/pay/${this.id}`;this.axios.post(l).then(r=>{this.getOrder(),h.fire({iconColor:"#004c34",iconHtml:'<i class="bi bi-check-circle-fill"></i>',text:`${r.data.message}`,showConfirmButton:!1,width:250,timer:1200})}).catch(r=>{h.fire({iconColor:"#992525",iconHtml:'<i class="bi bi-exclamation-triangle-fill"></i>',text:`${r.response.data.message}`,showConfirmButton:!1,width:250,timer:1500})})}},mounted(){this.getOrder()}},T={class:"container-md"},V={class:"py-5"},B={class:"mb-5 d-flex flex-column flex-sm-row text-center justify-content-center align-items-center"},C=S('<div class="bg-primary text-light p-3 w-100"><span class="fs-7">Step.1</span><p class="mb-0">訂單建立</p></div><i class="bi bi-arrow-right fs-4 mx-2 d-none d-sm-block"></i><i class="bi bi-arrow-down fs-4 mb-2 d-sm-none"></i>',3),L=s("span",{class:"fs-7"},"Step.2",-1),O=s("p",{class:"mb-0"},"確認結帳",-1),A=[L,O],I=s("i",{class:"bi bi-arrow-right fs-4 mx-2 d-none d-sm-block"},null,-1),N=s("i",{class:"bi bi-arrow-down fs-4 mb-2 d-sm-none"},null,-1),P=s("span",{class:"fs-7"},"Step.3",-1),R=s("p",{class:"mb-0"},"完成訂單",-1),j=[P,R],D={key:0,class:"bg-primary text-secondary fw-bold p-5 text-center mb-3"},H=s("i",{class:"bi bi-credit-card-fill fs-1"},null,-1),U=s("h3",{class:"text-light mt-3"},"訂單已建立",-1),q=s("h3",{class:"text-light"},"請盡速付款",-1),z=[H,U,q],F={key:1,class:"bg-primary text-secondary p-5 text-center mb-3"},M=s("i",{class:"bi bi-check-circle-fill fs-1"},null,-1),G=s("h3",{class:"fw-bold text-light mt-3 mb-2"},"付款成功",-1),J=s("p",{class:"text-light mb-0"},"謝謝您的光臨！",-1),K=s("p",{class:"text-light mb-2"},"商品將於 3 天內寄出，請留意包裹訊息",-1),Q={class:"d-flex flex-column flex-md-row justify-content-center"},W={class:"row flex-row-reverse"},X={class:"col-lg-5"},Y={class:"border p-4 mb-4"},Z=s("h4",{class:"fw-bold mb-3"},"訂單明細",-1),$={class:"table mt-4 text-primary"},ss=s("th",{scope:"row",class:"border-0"},"付款狀態",-1),ts={key:0,class:"text-end border-0 h4 fw-bold text-danger"},es={key:1,class:"text-end border-0 h4 fw-bold"},os=s("th",{scope:"row",class:"border-0"},"訂單編號",-1),ds={class:"text-end border-0"},rs={class:"border-bottom"},is=s("th",{scope:"row",class:"border-0"},"訂購時間",-1),ls={class:"text-end border-0"},cs=s("th",{scope:"row",class:"border-0"},"姓名",-1),ns={class:"text-end border-0"},as=s("th",{scope:"row",class:"border-0"},"Email",-1),_s={class:"text-end border-0"},hs=s("th",{scope:"row",class:"border-0"},"地址",-1),bs={class:"text-end border-0"},ps=s("th",{scope:"row",class:"border-0"},"留言",-1),ms={key:0,class:"border-0 text-end text-break"},us={key:1,class:"text-end border-0 text-muted"},xs=["disabled"],fs={class:"col-lg-7"},gs={class:"table text-primary"},ws=s("thead",null,[s("tr",null,[s("th",{class:"ps-0"},"商品名稱"),s("th",{class:"d-none d-md-table-cell",width:"20%"},"數量"),s("th",{class:"d-none d-md-table-cell",width:"20%"},"單價"),s("th",{class:"d-none d-md-table-cell text-end",width:"20%"},"小計")])],-1),ys={scope:"row",class:"border-0 px-0 py-4 d-flex align-items-center"},vs=["src","alt"],ks={class:"ms-3"},Ss={class:"mb-2 fw-bold"},Es={class:"d-md-none"},Ts={class:"mb-2"},Vs={class:"text-start"},Bs={class:"border-0 align-middle d-none d-md-table-cell"},Cs={class:"mb-0 fw-bold"},Ls={class:"border-0 align-middle d-none d-md-table-cell"},Os={class:"mb-0 pe-5"},As={class:"border-0 align-middle d-none d-md-table-cell text-end"},Is={class:"mb-0 pe-2"},Ns={class:"text-end fw-bold"},Ps=s("td",{colspan:"2"},"總金額",-1),Rs={colspan:"2",class:"fs-3"};function js(l,r,Ds,Hs,t,a){const y=b("loading-component"),_=b("router-link");return d(),i(f,null,[t.order.is_paid?(d(),p(m,{key:1,to:"title"},[c(" | 謝謝惠顧")])):(d(),p(m,{key:0,to:"title"},[c(" | 訂單已建立")])),n(y,{active:t.isLoading,"z-index":1060},null,8,["active"]),s("div",T,[s("div",V,[s("div",B,[C,s("div",{class:u(["text-light p-3 w-100",t.order.is_paid?"bg-primary":"bg-secondary"])},A,2),I,N,s("div",{class:u(["bg-primary text-light p-3 w-100",t.order.is_paid?"bg-secondary":"bg-primary"])},j,2)]),t.order.is_paid?(d(),i("div",F,[M,G,J,K,s("div",Q,[n(_,{to:"/menu",class:"btn btn-outline-secondary text-light mx-2 mb-2 mb-md-0"},{default:x(()=>[c("看看菜單")]),_:1}),n(_,{to:"/products",class:"btn btn-secondary text-light mx-2"},{default:x(()=>[c("繼續選購")]),_:1})])])):(d(),i("div",D,z)),s("div",W,[s("div",X,[s("div",Y,[Z,s("table",$,[s("tbody",null,[s("tr",null,[ss,t.order.is_paid?(d(),i("td",es,"已付款")):(d(),i("td",ts,"尚未付款"))]),s("tr",null,[os,s("td",ds,e(t.order.id),1)]),s("tr",rs,[is,s("td",ls,e(l.$filters.date(t.order.create_at)),1)]),s("tr",null,[cs,s("td",ns,e(t.order.user.name),1)]),s("tr",null,[as,s("td",_s,e(t.order.user.email),1)]),s("tr",null,[hs,s("td",bs,e(t.order.user.address),1)]),s("tr",null,[ps,t.order.message?(d(),i("td",ms,e(t.order.message),1)):(d(),i("td",us,"（空白）"))])])]),s("button",{class:"btn btn-lg btn-primary w-100",onClick:r[0]||(r[0]=(...o)=>a.payOrder&&a.payOrder(...o)),disabled:t.order.is_paid}," 付款 ",8,xs)])]),s("div",fs,[s("table",gs,[ws,s("tbody",null,[(d(!0),i(f,null,k(t.order.products,o=>(d(),i("tr",{class:"border-bottom border-top",key:o.id},[s("th",ys,[s("img",{src:o.product.imageUrl,alt:o.product.title,class:"object-cover img-fluid",style:{width:"72px",height:"72px"}},null,8,vs),s("div",ks,[s("p",Ss,e(o.product.title),1),s("div",Es,[s("div",Ts," $"+e(o.total),1),s("span",Vs,"數量："+e(o.qty),1)])])]),s("td",Bs,[s("p",Cs,e(o.qty),1)]),s("td",Ls,[s("p",Os,"NT$ "+e(o.product.price),1)]),s("td",As,[s("p",Is,"NT$ "+e(o.total),1)])]))),128))]),s("tfoot",null,[s("tr",Ns,[Ps,s("td",Rs,"$ "+e(t.order.total),1)])])])])])])])],64)}const zs=v(E,[["render",js]]);export{zs as default};
