import{S as h}from"./sweetalert2.all-ab121e13.js";import{_ as U,o as l,c as i,b as t,D as c,H as u,F as y,h as P,I as C,M as x,r as b,i as V,f as B,T as E,d as _,n as I,t as f}from"./index-09a2d12a.js";import{P as L}from"./PaginationComponent-1773c2d0.js";import{D as A}from"./DeleteModal-08afd086.js";const D={props:["tempProduct","isNew"],emits:["update-product"],data(){return{product:{}}},methods:{addImages(){this.product.imagesUrl=[],this.product.imagesUrl.push("")}},watch:{tempProduct(){this.product=this.tempProduct}}},N={class:"modal-dialog modal-xl"},T={class:"modal-content border-0"},H={class:"modal-header bg-primary text-white"},S={id:"productModalLabel",class:"modal-title"},R={key:0},j={key:1},z=t("button",{type:"button",class:"btn-close btn-close-white","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),F={class:"modal-body"},O={class:"row"},q={class:"col-sm-4"},G={class:"mb-2"},J={class:"mb-3"},K=t("label",{for:"imageUrl",class:"form-label"},"輸入圖片網址",-1),Q=["src"],W=t("h4",null,"多圖設置",-1),X={key:0},Y=["onUpdate:modelValue"],Z=["src"],$={key:1},tt={class:"col-sm-8"},et={class:"mb-3"},ot=t("label",{for:"title",class:"form-label"},"標題",-1),st={class:"row"},lt={class:"mb-3 col-md-6"},it=t("label",{for:"category",class:"form-label"},"分類",-1),nt={class:"mb-3 col-md-6"},dt=t("label",{for:"price",class:"form-label"},"單位",-1),rt={class:"row"},ct={class:"mb-3 col-md-6"},at=t("label",{for:"origin_price",class:"form-label"},"原價",-1),ut={class:"mb-3 col-md-6"},pt=t("label",{for:"price",class:"form-label"},"售價",-1),mt=t("hr",null,null,-1),ht={class:"mb-3"},bt=t("label",{for:"description",class:"form-label"},"產品描述",-1),_t={class:"mb-3"},ft=t("label",{for:"content",class:"form-label"},"說明內容",-1),gt={class:"mb-3"},vt={class:"form-check"},yt=t("label",{class:"form-check-label",for:"is_enabled"},"是否啟用",-1),wt={class:"modal-footer"},xt=t("button",{type:"button",class:"btn btn-outline-gray","data-bs-dismiss":"modal"}," 取消 ",-1);function Ut(n,e,d,m,o,a){return l(),i("div",N,[t("div",T,[t("div",H,[t("h5",S,[d.isNew?(l(),i("span",R,"新增產品")):(l(),i("span",j,"編輯產品"))]),z]),t("div",F,[t("div",O,[t("div",q,[t("div",G,[t("div",J,[K,c(t("input",{type:"text",class:"form-control",placeholder:"請輸入圖片連結","onUpdate:modelValue":e[0]||(e[0]=s=>o.product.imageUrl=s)},null,512),[[u,o.product.imageUrl]])]),t("img",{class:"img-fluid",src:o.product.imageUrl,alt:"產品圖片"},null,8,Q)]),t("div",null,[W,Array.isArray(o.product.imagesUrl)?(l(),i("div",X,[(l(!0),i(y,null,P(o.product.imagesUrl,(s,p)=>(l(),i(y,{key:p+123},[c(t("input",{type:"text",class:"form-control","onUpdate:modelValue":w=>o.product.imagesUrl[p]=w},null,8,Y),[[u,o.product.imagesUrl[p]]]),t("img",{class:"img-fluid mb-2",src:o.product.imagesUrl[p],alt:"產品圖片"},null,8,Z)],64))),128)),!o.product.imagesUrl.length||o.product.imagesUrl[o.product.imagesUrl.length-1]?(l(),i("button",{key:0,type:"button",class:"btn btn-outline-primary btn-sm d-block w-100",onClick:e[1]||(e[1]=s=>o.product.imagesUrl.push(""))}," 新增圖片 ")):(l(),i("button",{key:1,type:"button",class:"btn btn-outline-danger btn-sm d-block w-100",onClick:e[2]||(e[2]=s=>o.product.imagesUrl.pop())}," 刪除圖片 "))])):(l(),i("div",$,[t("button",{type:"button",class:"btn btn-outline-primary btn-sm d-block w-100",onClick:e[3]||(e[3]=(...s)=>a.addImages&&a.addImages(...s))}," 新增圖片 ")]))])]),t("div",tt,[t("div",et,[ot,c(t("input",{id:"title",type:"text",class:"form-control",placeholder:"請輸入標題","onUpdate:modelValue":e[4]||(e[4]=s=>o.product.title=s)},null,512),[[u,o.product.title]])]),t("div",st,[t("div",lt,[it,c(t("input",{id:"category",type:"text",class:"form-control",placeholder:"請輸入分類","onUpdate:modelValue":e[5]||(e[5]=s=>o.product.category=s)},null,512),[[u,o.product.category]])]),t("div",nt,[dt,c(t("input",{id:"unit",type:"text",class:"form-control",placeholder:"請輸入單位","onUpdate:modelValue":e[6]||(e[6]=s=>o.product.unit=s)},null,512),[[u,o.product.unit]])])]),t("div",rt,[t("div",ct,[at,c(t("input",{id:"origin_price",type:"number",min:"0",class:"form-control",placeholder:"請輸入原價","onUpdate:modelValue":e[7]||(e[7]=s=>o.product.origin_price=s)},null,512),[[u,o.product.origin_price]])]),t("div",ut,[pt,c(t("input",{id:"price",type:"number",min:"0",class:"form-control",placeholder:"請輸入售價","onUpdate:modelValue":e[8]||(e[8]=s=>o.product.price=s)},null,512),[[u,o.product.price]])])]),mt,t("div",ht,[bt,c(t("textarea",{id:"description",type:"text",class:"form-control",placeholder:"請輸入產品描述","onUpdate:modelValue":e[9]||(e[9]=s=>o.product.content=s)},`\r
                            `,512),[[u,o.product.content]])]),t("div",_t,[ft,c(t("textarea",{id:"description",type:"text",class:"form-control",placeholder:"請輸入說明內容","onUpdate:modelValue":e[10]||(e[10]=s=>o.product.description=s)},`\r
                            `,512),[[u,o.product.description]])]),t("div",gt,[t("div",vt,[c(t("input",{id:"is_enabled",class:"form-check-input",type:"checkbox","true-value":1,"false-value":0,"onUpdate:modelValue":e[11]||(e[11]=s=>o.product.is_enabled=s)},null,512),[[C,o.product.is_enabled]]),yt])])])])]),t("div",wt,[xt,t("button",{type:"button",class:"btn btn-primary",onClick:e[12]||(e[12]=s=>n.$emit("update-product",d.tempProduct))}," 確認 ")])])])}const Pt=U(D,[["render",Ut]]),{VITE_BASEURL:g,VITE_APIPATH:v}={VITE_BASEURL:"https://vue3-course-api.hexschool.io",VITE_APIPATH:"hmjbs",BASE_URL:"/pomme/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},Mt={components:{PaginationComponent:L,DeleteModal:A,ProductModal:Pt},data(){return{products:[],tempProduct:{imagesUrl:[]},pagination:{},isNew:!0,isLoading:!1,deleteModal:null,productModal:null}},methods:{getProducts(n=1){this.isLoading=!0;const e=`${g}/v2/api/${v}/admin/products?page=${n}`;this.axios.get(e).then(d=>{this.products=d.data.products,this.pagination=d.data.pagination,this.isLoading=!1}).catch(d=>{this.isLoading=!1,h.fire({iconColor:"#992525",iconHtml:'<i class="bi bi-exclamation-triangle-fill"></i>',text:`${d.response.data.message}`,showConfirmButton:!1,width:250,timer:1500})})},updateProduct(n){let e=`${g}/v2/api/${v}/admin/product`,d="post";this.isNew||(e=`${g}/v2/api/${v}/admin/product/${n.id}`,d="put"),this.axios[d](e,{data:n}).then(m=>{h.fire({iconColor:"#004c34",iconHtml:'<i class="bi bi-check-circle-fill"></i>',text:`${m.data.message}`,showConfirmButton:!1,width:250,timer:1200}),this.productModal.hide(),this.getProducts()}).catch(m=>{h.fire({iconColor:"#992525",iconHtml:'<i class="bi bi-exclamation-triangle-fill"></i>',text:`${m.response.data.message}`,showConfirmButton:!1,width:250,timer:1500})})},deleteProduct(){const n=`${g}/v2/api/${v}/admin/product/${this.tempProduct.id}`;this.axios.delete(n).then(e=>{h.fire({iconColor:"#004c34",iconHtml:'<i class="bi bi-check-circle-fill"></i>',text:`${e.data.message}`,showConfirmButton:!1,width:250,timer:1200}),this.deleteModal.hide(),this.getProducts()}).catch(e=>{h.fire({iconColor:"#992525",iconHtml:'<i class="bi bi-exclamation-triangle-fill"></i>',text:`${e.response.data.message}`,showConfirmButton:!1,width:250,timer:1500})})},openModal(n,e){n==="delete"?(this.tempProduct={...e},this.deleteModal.show()):n==="edit"?(this.isNew=!1,this.tempProduct={...e},this.productModal.show()):n==="new"&&(this.isNew=!0,this.tempProduct={imagesUrl:[]},this.productModal.show())}},mounted(){this.getProducts(),this.deleteModal=new x("#deleteModal"),this.productModal=new x("#productModal")}},kt={class:"container p-5"},Ct={class:"d-flex justify-content-between mb-4"},Vt=t("h1",{class:"h2 fw-bold"},"商品管理",-1),Bt={class:"table table-hover mb-4"},Et=t("thead",{class:"table-dark"},[t("tr",null,[t("th",{width:"120"}," 分類 "),t("th",null,"產品名稱"),t("th",{width:"120"}," 原價 "),t("th",{width:"120"}," 售價 "),t("th",{width:"100"}," 是否啟用 "),t("th",{width:"120"}," 編輯 ")])],-1),It={key:0,class:"text-success"},Lt={key:1},At={class:"btn-group"},Dt=["onClick"],Nt=["onClick"],Tt={id:"productModal",ref:"productModal",class:"modal fade",tabindex:"-1","aria-labelledby":"productModalLabel","aria-hidden":"true"},Ht={id:"deleteModal",ref:"deleteModal",class:"modal fade",tabindex:"-1","aria-labelledby":"delProductModalLabel","aria-hidden":"true"};function St(n,e,d,m,o,a){const s=b("loading-component"),p=b("pagination-component"),w=b("product-modal"),M=b("delete-modal");return l(),i(y,null,[(l(),V(E,{to:"title"},[B(" | 商品管理")])),_(s,{active:o.isLoading,"z-index":1060},null,8,["active"]),t("div",kt,[t("div",Ct,[Vt,t("button",{type:"button",class:"btn btn-primary",onClick:e[0]||(e[0]=r=>a.openModal("new"))}," 建立新的商品 ")]),t("table",Bt,[Et,t("tbody",null,[(l(!0),i(y,null,P(o.products,r=>(l(),i("tr",{key:r.id,class:I({"text-muted":!r.is_enabled})},[t("td",null,f(r.category),1),t("td",null,f(r.title),1),t("td",null,f(r.origin_price),1),t("td",null,f(r.price),1),t("td",null,[r.is_enabled?(l(),i("span",It,"啟用")):(l(),i("span",Lt,"未啟用"))]),t("td",null,[t("div",At,[t("button",{type:"button",class:"btn btn-outline-primary btn-sm",onClick:k=>a.openModal("edit",r)}," 編輯 ",8,Dt),t("button",{type:"button",class:"btn btn-outline-danger btn-sm","data-bs-toggle":"modal","data-bs-target":"#deleteModal",onClick:k=>a.openModal("delete",r)}," 刪除 ",8,Nt)])])],2))),128))])]),_(p,{onEmitPages:a.getProducts,pages:o.pagination},null,8,["onEmitPages","pages"]),t("div",Tt,[_(w,{"is-new":o.isNew,"temp-product":o.tempProduct,onUpdateProduct:a.updateProduct},null,8,["is-new","temp-product","onUpdateProduct"])],512),t("div",Ht,[_(M,{item:o.tempProduct,onDelItem:a.deleteProduct},null,8,["item","onDelItem"])],512)])],64)}const Ot=U(Mt,[["render",St]]);export{Ot as default};
